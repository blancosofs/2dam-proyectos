
```
package uiPaneles;

  

import javax.swing.JLabel;

import javax.swing.JOptionPane;

import javax.swing.JPanel;

import javax.swing.JScrollPane;

import javax.swing.JTextArea;

  

import service.NoticiasService;

  

import java.awt.event.ActionEvent;

import java.awt.event.ActionListener;

import java.util.ArrayList;

import java.util.List;

import java.util.Properties;

import java.util.ResourceBundle.Control;

  

import javax.mail.Authenticator;

import javax.mail.Message;

import javax.mail.PasswordAuthentication;

import javax.mail.Session;

import javax.mail.Transport;

import javax.mail.internet.InternetAddress;

import javax.mail.internet.MimeMessage;

import javax.swing.JButton;

import javax.swing.JTextField;

  

import common.ControlErrores;

import dao.NoticiasDAO;

import domain.Noticias;

  

public class PanelTest extends JPanel {

private static final long serialVersionUID = 1L;

  

private JLabel lbl_msgEmail;

private JTextArea textArea_NoticiasCompleto;

  

private JButton btnNextTest;

private JButton btn_volver;

  

private JTextField textField_email;

  

/*

* public static void main(String[] args) { List<Noticias> fuentes =

* NoticiasDAO.extraerNoticiasObjeto(); for (Noticias n : fuentes) {

* System.out.println(n); } }

*/

  

public PanelTest() {

setLayout(null);

setBounds(0, 0, 1200, 800);

  

lbl_msgEmail = new JLabel("Email:");

lbl_msgEmail.setBounds(22, 121, 129, 16);

add(lbl_msgEmail);

  

textField_email = new JTextField();

textField_email.setBounds(163, 116, 1007, 26);

add(textField_email);

textField_email.setColumns(10);

  

textArea_NoticiasCompleto = new JTextArea("----\nNoticias\n---\n");

textArea_NoticiasCompleto.setEditable(false);

textArea_NoticiasCompleto.setLineWrap(true);

textArea_NoticiasCompleto.setWrapStyleWord(true);

add(textArea_NoticiasCompleto);

  

btnNextTest = new JButton("enviar");

btnNextTest.setBounds(1081, 732, 92, 29);

btnNextTest.addActionListener(new ActionListener() {

public void actionPerformed(ActionEvent e) {

if ((textField_email.getText()) != null) {

if (!ControlErrores.comprobarEmail()) {

String msg = "[error] Email vacio";

JOptionPane.showMessageDialog(null, msg, "", 1);

} else {

  

final String fromEmail = "sofiablanco.cal@gmail.com";

final String password = "fvtr pbjr czbk jylm";

final String toEmail = textField_email.getText();

final StringBuilder sb = new StringBuilder();

  

Properties props = new Properties();

  

props.put("mail.smtp.host", "smtp.gmail.com");

props.put("mail.smtp.socketFactory.port", "465");

props.put("mail.smtp.socketFactory.class", "javax.net.ssl.SSLSocketFactory");

props.put("mail.smtp.auth", "true");

props.put("mail.smtp.port", "465");

  

sb.append("FECHA/HORA(se encuentra en desarrollo)");

  

sb.append(textArea_NoticiasCompleto);

  

Authenticator auth = new Authenticator() {

protected PasswordAuthentication getPasswordAuthentication() {

return new PasswordAuthentication(fromEmail, password);

}

};

  

Session session = Session.getDefaultInstance(props, auth);

sendEmail(session, toEmail, "NOTICIAS DAM", sb.toString());

}

} else {

String msg = "[error] Email vacio";

JOptionPane.showMessageDialog(null, msg, "", 1);

}

  

}

});

add(btnNextTest);

  

btn_volver = new JButton("<--");

btn_volver.setBounds(20, 764, 117, 29);

btn_volver.addActionListener(new ActionListener() {

public void actionPerformed(ActionEvent e) {

// como cambio al panel padre sin pasarselo como parametro

}

});

add(btn_volver);

  

}

  

public static void sendEmail(Session session, String toEmail, String subject, String body) {

try {

MimeMessage msg = new MimeMessage(session);

  

msg.addHeader("Content-type", "text/HTML; charset=UTF-8");

msg.addHeader("format", "flowed");

msg.addHeader("Content-Transfer-Encoding", "8bit");

msg.setFrom(new InternetAddress("no_reply@example.com", "BLANCO SOFIA"));

msg.setReplyTo(InternetAddress.parse("no_reply_DOSA@DAM.com", false));

msg.setSubject(subject, "UTF-8");

msg.setText(body, "UTF-8");

msg.setRecipients(Message.RecipientType.TO, InternetAddress.parse(toEmail, false));

  

Transport.send(msg);

  

} catch (Exception e) {

e.printStackTrace();

}

}

}
```